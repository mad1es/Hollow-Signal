# Changelog - Hollow Signal

## Версия 2.0 - LLM Integration & Dark Theme

### Основные изменения

#### Визуальные улучшения
- ✅ **Черный фон** вместо белого
- ✅ **Белый текст** с легким свечением
- ✅ **Психоделические эффекты** в фазе anomalies (едва заметные цветные пятна)
- ✅ **Размытие текста** в фазе anomalies для пугающего эффекта

#### Интеграция LLM
- ✅ **OpenAI API интеграция** для генерации ответов
- ✅ **Системный промпт** настроен на создание пугающих, тонких ответов
- ✅ **Контекстные данные** передаются в LLM (местоположение, движение, аудио)
- ✅ **Fallback система** - если API недоступен, используются прямые реакции

#### Система записи данных
- ✅ **Полная запись всех данных**:
  - Аудио запись (M4A формат)
  - Движения (гироскоп, акселерометр)
  - Местоположение (GPS)
  - Уровень батареи
  - Состояние зарядки
  - Датчик приближения
  - Транскрипции речи
- ✅ **Структурированное хранение** всех данных сессии

#### Фейс-трекинг
- ✅ **Vision framework** для отслеживания лица
- ✅ **Анализ выражения лица** (напряжение, улыбка, грусть, удивление, усталость)
- ✅ **Интеграция с LLM** - выражение лица передается в контекст

#### Улучшенные реакции
- ✅ **Тонкие, неочевидные реакции** вместо прямых ("Что-то изменилось" вместо "Вы двигаетесь")
- ✅ **LLM генерирует ответы** на основе всех данных
- ✅ **Убраны очевидные упоминания** датчиков и движений
- ✅ **Психологические приёмы** для нагнетания страха

#### Новые разрешения
- ✅ **Местоположение** (NSLocationWhenInUseUsageDescription)
- ✅ **Камера** (уже было, теперь используется для фейс-трекинга)

### Технические детали

#### Новые файлы
- `LLMService.swift` - сервис для работы с OpenAI API
- `DataRecorder.swift` - система записи всех данных
- `FaceTracker.swift` - фейс-трекинг через Vision framework

#### Изменённые файлы
- `ContentView.swift` - черный фон, психоделические эффекты
- `GameStateManager.swift` - черный фон по умолчанию
- `ReactionEngine.swift` - интеграция с LLM, тонкие реакции
- `HollowSignalApp.swift` - добавлены новые сервисы
- `Info.plist` - добавлены разрешения для местоположения

### Настройка

Для работы LLM необходимо:
1. Получить API ключ от OpenAI
2. Добавить его в переменные окружения (см. `API_SETUP.md`)

### Известные ограничения

- LLM требует активное интернет-соединение
- API ключ должен быть настроен для работы LLM
- Фейс-трекинг работает только на реальном устройстве (не в симуляторе)
- Запись аудио требует разрешения пользователя

### Следующие шаги

- [ ] Добавить сохранение записанных данных между сессиями
- [ ] Реализовать экспорт данных сессии
- [ ] Добавить больше психоделических эффектов
- [ ] Улучшить анализ выражения лица
- [ ] Добавить поддержку других LLM провайдеров

